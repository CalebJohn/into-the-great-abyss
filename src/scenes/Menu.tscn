[gd_scene load_steps=12 format=1]

[ext_resource path="res://src/scripts/Main.gd" type="Script" id=1]
[ext_resource path="res://assets/themes/defaultTheme.tres" type="Theme" id=2]
[ext_resource path="res://src/scripts/Menu.gd" type="Script" id=3]
[ext_resource path="res://assets/fonts/Title.fnt" type="BitmapFont" id=4]
[ext_resource path="res://src/scripts/SeedValue.gd" type="Script" id=5]
[ext_resource path="res://src/scripts/MenuBackground.gd" type="Script" id=6]

[sub_resource type="StyleBoxEmpty" id=1]

content_margin/left = -1.0
content_margin/right = -1.0
content_margin/top = -1.0
content_margin/bottom = -1.0

[sub_resource type="StyleBoxEmpty" id=2]

content_margin/left = -1.0
content_margin/right = -1.0
content_margin/top = -1.0
content_margin/bottom = -1.0

[sub_resource type="StyleBoxEmpty" id=3]

content_margin/left = -1.0
content_margin/right = -1.0
content_margin/top = -1.0
content_margin/bottom = -1.0

[sub_resource type="CanvasItemShader" id=4]

_code = { "fragment":"//uniform time = TIME\nuniform vec2 mouse = vec2(0, 0);\nuniform vec2 resolution = vec2(1024, 600);\n\n\nfloat hash(vec2 p) {\n  return fract(sin(dot(p*11.5, vec2(43.232, 75.876)))*45246.32957);\n}\n\n//Based off of iq\'s described here: http://www.iquilezles.org/www/articles/voronoilin\nfloat voronoi(vec2 p, float s) {\n  vec2 n = floor(p);\n  vec2 f = fract(p);\n  float md = 5.0;\n  vec2 m = vec2(0.0);\n//Repeat enough times\n//-1, -1\n      vec2 g = vec2(-1, -1);\n\t  vec2 hash2 = fract(vec2(sin(dot(n+g, vec2(123.4, 748.6))), sin(dot(n+g, vec2(547.3, 659.3))))*5232.85324);\n      vec2 o = hash2*vec2(s, s);\n      o = vec2(0.5, 0.5) + vec2(0.5, 0.5) * vec2(sin(0.64 + 5.038*o.x), sin(0.64 + 5.038*o.y));\n      vec2 r = g + o - f;\n      float d = dot(r, r);\n      if (d<md) {\n        md = d;\n        m = n+g+o;\n      }\n//-1, 0\n      g = vec2(-1.0, 0.0);\n\t  hash2 = fract(vec2(sin(dot(n+g, vec2(123.4, 748.6))), sin(dot(n+g, vec2(547.3, 659.3))))*5232.85324);\n      o = hash2*s;\n      o = vec2(0.5, 0.5) + vec2(0.5, 0.5) * vec2(sin(0.64 + 5.038*o.x), sin(0.64 + 5.038*o.y));\n      r = g + o - f;\n      d = dot(r, r);\n      if (d<md) {\n        md = d;\n        m = n+g+o;\n      }\n//-1, 1\n      g = vec2(-1, 1);\n\t  hash2 = fract(vec2(sin(dot(n+g, vec2(123.4, 748.6))), sin(dot(n+g, vec2(547.3, 659.3))))*5232.85324);\n      o = hash2*s;\n      o = vec2(0.5, 0.5) + vec2(0.5, 0.5) * vec2(sin(0.64 + 5.038*o.x), sin(0.64 + 5.038*o.y));\n      r = g + o - f;\n      d = dot(r, r);\n      if (d<md) {\n        md = d;\n        m = n+g+o;\n      }\n//0, -1\n      g = vec2(0, -1);\n\t  hash2 = fract(vec2(sin(dot(n+g, vec2(123.4, 748.6))), sin(dot(n+g, vec2(547.3, 659.3))))*5232.85324);\n      o = hash2*s;\n      o = vec2(0.5, 0.5) + vec2(0.5, 0.5) * vec2(sin(0.64 + 5.038*o.x), sin(0.64 + 5.038*o.y));\n      r = g + o - f;\n      d = dot(r, r);\n      if (d<md) {\n        md = d;\n        m = n+g+o;\n      }\n//0, 0\n      g = vec2(0, 0);\n\t  hash2 = fract(vec2(sin(dot(n+g, vec2(123.4, 748.6))), sin(dot(n+g, vec2(547.3, 659.3))))*5232.85324);\n      o = hash2*s;\n      o = vec2(0.5, 0.5) + vec2(0.5, 0.5) * vec2(sin(0.64 + 5.038*o.x), sin(0.64 + 5.038*o.y));\n      r = g + o - f;\n      d = dot(r, r);\n      if (d<md) {\n        md = d;\n        m = n+g+o;\n      }\n//0, 1\n      g = vec2(0, 1);\n\t  hash2 = fract(vec2(sin(dot(n+g, vec2(123.4, 748.6))), sin(dot(n+g, vec2(547.3, 659.3))))*5232.85324);\n      o = hash2*s;\n      o = vec2(0.5, 0.5) + vec2(0.5, 0.5) * vec2(sin(0.64 + 5.038*o.x), sin(0.64 + 5.038*o.y));\n      r = g + o - f;\n      d = dot(r, r);\n      if (d<md) {\n        md = d;\n        m = n+g+o;\n      }\n//1, -1\n      g = vec2(1, -1);\n\t  hash2 = fract(vec2(sin(dot(n+g, vec2(123.4, 748.6))), sin(dot(n+g, vec2(547.3, 659.3))))*5232.85324);\n      o = hash2*s;\n      o = vec2(0.5, 0.5) + vec2(0.5, 0.5) * vec2(sin(0.64 + 5.038*o.x), sin(0.64 + 5.038*o.y));\n      r = g + o - f;\n      d = dot(r, r);\n      if (d<md) {\n        md = d;\n        m = n+g+o;\n      }\n//1, 0\n      g = vec2(1, 0);\n\t  hash2 = fract(vec2(sin(dot(n+g, vec2(123.4, 748.6))), sin(dot(n+g, vec2(547.3, 659.3))))*5232.85324);\n      o = hash2*s;\n      o = vec2(0.5, 0.5) + vec2(0.5, 0.5) * vec2(sin(0.64 + 5.038*o.x), sin(0.64 + 5.038*o.y));\n      r = g + o - f;\n      d = dot(r, r);\n      if (d<md) {\n        md = d;\n        m = n+g+o;\n      }\n//1, 1\n      g = vec2(1, 1);\n\t  hash2 = fract(vec2(sin(dot(n+g, vec2(123.4, 748.6))), sin(dot(n+g, vec2(547.3, 659.3))))*5232.85324);\n      o = hash2*s;\n      o = vec2(0.5, 0.5) + vec2(0.5, 0.5) * vec2(sin(0.64 + 5.038*o.x), sin(0.64 + 5.038*o.y));\n      r = g + o - f;\n      d = dot(r, r);\n      if (d<md) {\n        md = d;\n        m = n+g+o;\n      }\n\treturn md;\n}\n\n//adjust uv\nvec2 uv = SCREEN_UV;\n//uv.x /= resolution.x;\n//uv.y /= resolution.y;\nuv.x *= (resolution.x / resolution.y);\n\nfloat sh = (resolution.y - mouse.y) / resolution.y;\n\n  //sun position\nvec2 sun = vec2(0.5*(resolution.x / resolution.y), -0.21+1.42*sh);\n  //calculate sky gradient\n     //stars\nvec3 nightsky = mix(vec3(0.2, 0.2, 0.6), vec3(1.0, 1.0, 0.8), (0.8*smoothstep(0.9992, 1.0, 1.0-voronoi(uv*10.0, 16.0))*(1.0-sh)*(1.0-sh)));\nnightsky = mix(nightsky, vec3(1.0, 1.0, 0.8), (0.2+0.8*smoothstep(0.996, 1.0, 1.0-voronoi(uv*vec2(35.0), 16.0))*(1.0-sh)*(1.0-sh)));\nnightsky = mix(nightsky, vec3(1.0, 1.0, 0.8), (0.8*smoothstep(0.99, 1.0, hash(uv))*(1.0-sh)*(1.0-sh)));\nvec3 zenith = mix(nightsky, vec3(0.4, 0.6, 1.0), sh);\nvec3 azimuth = mix(vec3(1.0, 0.4, 0.4), vec3(0.75, 0.9, 1.0), sh);\nvec3 skygrad = mix(azimuth, zenith, smoothstep(0.0, 0.7+0.2*(cos((1.0-sh)*3.14159*3.0)), uv.y));\n\n  //add the sun\nvec3 col = mix(vec3(1.0, 0.2+0.8*sh, 0.0), skygrad, smoothstep(0.2, 0.203, length(sun-uv)));\n\n  // make some thin wispy clouds\n\n\n  // terrain\n//ov will be replaced with an inlined voronoi\nfloat h = 0.0;//ov(vec2(uv.x, 1.0));\n//fake fbm loop//unpacked the loop here\nvec2 fuv = vec2(uv.x, 1.0);\nh+= voronoi(fuv*1.0, 1.0)*0.4;\nh+= voronoi(fuv*2.0, 1.0)*0.2;\nh+= voronoi(fuv*4.0, 1.0)*0.1;\nh+= voronoi(fuv*8.0, 1.0)*0.05;\nh+= voronoi(fuv*16.0, 1.0)*0.025;\nh+= voronoi(fuv*32.0, 1.0)*0.0125;\n\ncol = mix(col, vec3(0.3+0.65*sh, 0.3+0.2*sh, 0.2+0.1*sh), smoothstep(0.028, 0.03, h-uv.y));\n\nCOLOR = vec4(col, 1.0);\n", "fragment_ofs":0, "light":"", "light_ofs":0, "vertex":"", "vertex_ofs":0 }

[sub_resource type="CanvasItemMaterial" id=5]

shader/shader = SubResource( 4 )
shader/shading_mode = 0
shader_param/mouse = Vector2( 0, 0 )
shader_param/resolution = Vector2( 1000, 600 )

[node name="Root" type="Control"]

anchor/right = 1
anchor/bottom = 1
focus/ignore_mouse = false
focus/stop_mouse = true
size_flags/horizontal = 2
size_flags/vertical = 2
margin/left = 0.0
margin/top = 0.0
margin/right = 0.0
margin/bottom = 0.0
script/script = ExtResource( 1 )

[node name="Menu" type="Control" parent="."]

anchor/right = 1
anchor/bottom = 1
focus/ignore_mouse = false
focus/stop_mouse = true
size_flags/horizontal = 2
size_flags/vertical = 2
theme/theme = ExtResource( 2 )
margin/left = 0.0
margin/top = 0.0
margin/right = 0.0
margin/bottom = 0.0
script/script = ExtResource( 3 )

[node name="Title" type="Label" parent="Menu"]

focus/ignore_mouse = true
focus/stop_mouse = true
size_flags/horizontal = 2
size_flags/vertical = 0
margin/left = 43.0
margin/top = 147.0
margin/right = 393.0
margin/bottom = 178.0
custom_fonts/font = ExtResource( 4 )
custom_colors/font_color = Color( 0.941176, 0.941176, 0.941176, 1 )
text = "POTENTIAL FORTNIGHT"
align = 1
percent_visible = 1.0
lines_skipped = 0
max_lines_visible = -1

[node name="StartButton" type="Button" parent="Menu" groups=[ "startMenu" ]]

anchor/left = 3
anchor/top = 3
anchor/right = 3
anchor/bottom = 3
focus/ignore_mouse = false
focus/stop_mouse = true
size_flags/horizontal = 2
size_flags/vertical = 2
margin/left = 40.0
margin/top = 30.0
margin/right = -40.0
margin/bottom = 10.0
toggle_mode = false
enabled_focus_mode = 2
shortcut = null
text = "START"
flat = true
__meta__ = { "_edit_lock_":true }

[node name="OptionsButton" type="Button" parent="Menu" groups=[ "startMenu" ]]

anchor/left = 3
anchor/top = 3
anchor/right = 3
anchor/bottom = 3
focus/ignore_mouse = false
focus/stop_mouse = true
size_flags/horizontal = 2
size_flags/vertical = 2
margin/left = 56.0
margin/top = -10.0
margin/right = -56.0
margin/bottom = -30.0
toggle_mode = false
enabled_focus_mode = 2
shortcut = null
text = "OPTIONS"
flat = true
__meta__ = { "_edit_lock_":true }

[node name="QuitButton" type="Button" parent="Menu" groups=[ "startMenu" ]]

anchor/left = 3
anchor/top = 3
anchor/right = 3
anchor/bottom = 3
focus/ignore_mouse = false
focus/stop_mouse = true
size_flags/horizontal = 2
size_flags/vertical = 2
margin/left = 30.0
margin/top = -50.0
margin/right = -30.0
margin/bottom = -75.0
toggle_mode = false
enabled_focus_mode = 2
shortcut = null
text = "QUIT"
flat = true
__meta__ = { "_edit_lock_":true }

[node name="FullscreenButton" type="Button" parent="Menu" groups=[ "optionsMenu" ]]

visibility/visible = false
anchor/left = 3
anchor/top = 3
anchor/right = 3
anchor/bottom = 3
focus/ignore_mouse = false
focus/stop_mouse = true
size_flags/horizontal = 2
size_flags/vertical = 2
margin/left = 84.0
margin/top = 70.0
margin/right = -84.0
margin/bottom = 40.0
toggle_mode = false
enabled_focus_mode = 2
shortcut = null
text = "FULLSCREEN"
flat = true
__meta__ = { "_edit_lock_":true }

[node name="MuteButton" type="Button" parent="Menu" groups=[ "optionsMenu" ]]

visibility/visible = false
anchor/left = 3
anchor/top = 3
anchor/right = 3
anchor/bottom = 3
focus/ignore_mouse = false
focus/stop_mouse = true
size_flags/horizontal = 2
size_flags/vertical = 2
margin/left = 66.0
margin/top = 30.0
margin/right = -66.0
margin/bottom = 10.0
toggle_mode = false
enabled_focus_mode = 2
shortcut = null
text = "MUTE: OFF"
flat = true
__meta__ = { "_edit_lock_":true }

[node name="SeedButton" type="Label" parent="Menu" groups=[ "optionsMenu" ]]

visibility/visible = false
anchor/left = 3
anchor/top = 3
anchor/right = 3
anchor/bottom = 3
focus/ignore_mouse = false
focus/stop_mouse = true
size_flags/horizontal = 2
size_flags/vertical = 2
margin/left = 56.0
margin/top = -10.0
margin/right = -56.0
margin/bottom = -35.0
text = "SEED:"
align = 1
percent_visible = 1.0
lines_skipped = 0
max_lines_visible = -1
__meta__ = { "_edit_lock_":true }

[node name="Value" type="LineEdit" parent="Menu/SeedButton"]

focus/ignore_mouse = false
focus/stop_mouse = true
size_flags/horizontal = 2
size_flags/vertical = 2
margin/left = 115.0
margin/top = 0.0
margin/right = 322.0
margin/bottom = 35.0
custom_styles/read_only = SubResource( 1 )
custom_styles/focus = SubResource( 2 )
custom_styles/normal = SubResource( 3 )
placeholder/alpha = 0.6
focus_mode = 2
caret/caret_blink = false
caret/caret_blink_speed = 0.65
script/script = ExtResource( 5 )

[node name="ReturnButton" type="Button" parent="Menu" groups=[ "optionsMenu" ]]

visibility/visible = false
anchor/left = 3
anchor/top = 3
anchor/right = 3
anchor/bottom = 3
focus/ignore_mouse = false
focus/stop_mouse = true
size_flags/horizontal = 2
size_flags/vertical = 2
margin/left = 56.0
margin/top = -50.0
margin/right = -56.0
margin/bottom = -70.0
toggle_mode = false
enabled_focus_mode = 2
shortcut = null
text = "RETURN"
flat = true
__meta__ = { "_edit_lock_":true }

[node name="Background" type="Polygon2D" parent="."]

visibility/behind_parent = true
material/material = SubResource( 5 )
transform/scale = Vector2( 1000, 600 )
polygon = Vector2Array( 0, 0, 1, 0, 1, 1, 0, 1 )
uv = Vector2Array( 0, 0, 1, 0, 1, 1, 0, 1 )
color = Color( 1, 1, 1, 1 )
vertex_colors = ColorArray(  )
offset = Vector2( 0, 0 )
texture/texture = null
texture/offset = Vector2( 0, 0 )
texture/scale = Vector2( 1, 1 )
texture/rotation = 0.0
invert/enable = false
invert/border = 100.0
script/script = ExtResource( 6 )
__meta__ = { "_edit_lock_":true }

[node name="Fader" type="CanvasModulate" parent="."]

color = Color( 1, 1, 1, 1 )

[connection signal="pressed" from="Menu/StartButton" to="Menu" method="_on_StartButton_pressed"]

[connection signal="pressed" from="Menu/OptionsButton" to="Menu" method="_on_OptionsButton_pressed"]

[connection signal="pressed" from="Menu/QuitButton" to="Menu" method="_on_QuitButton_pressed"]

[connection signal="pressed" from="Menu/FullscreenButton" to="Menu" method="_on_FullscreenButton_pressed"]

[connection signal="pressed" from="Menu/MuteButton" to="Menu" method="_on_MuteButton_pressed"]

[connection signal="text_changed" from="Menu/SeedButton/Value" to="Menu" method="_on_Value_text_changed"]

[connection signal="pressed" from="Menu/ReturnButton" to="Menu" method="_on_ReturnButton_pressed"]


